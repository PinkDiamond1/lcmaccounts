<%# Copyright 2011-2012 Rice University. Licensed under the Affero General Public 
    License version 3 or later.  See the COPYRIGHT file for details. %>

<% content_for :javascript do %>
  <script type="text/javascript">
    $('.verify-email').bind('ajax:complete', function(evt, xhr, status) {
      $(this).replaceWith(xhr.responseText);
    });
  </script>
<% end %>

<%= form_for([:admin, @user]) do |f| %>
  <%= render "shared/error_messages", :target => @user %> 

  <div class="form-group">
    <%= f.label :name %>
    <div><%= @user.name %></div>
  </div>

  <div class="form-group">
    <%= f.label :existing_email_addresses %>
    <ul>
    <% @user.email_addresses.each do |email| %>
      <li>
      <%= email.value %>
      <% if email.verified %>
        (Verified)
      <% else %>
        <%= link_to 'Mark this email address as verified', admin_verify_contact_info_path(email),
                    remote: true, method: :post, class: 'btn btn-default btn-xs verify-email'
        %>
      <% end %>
      </li>
    <% end %>
    </ul>
  </div>

  <div class="checkbox">
    <%= f.label :is_administrator, 'Administrator?' %>
    <%= f.check_box :is_administrator %>
  </div>

  <div class="checkbox">
    <%= f.label :disable, 'Disabled Account?' %>
    <%= check_box_tag 'user[disable]', !@user.is_activated? %>
  </div>

  <div class="actions">
    <%= f.submit 'Save', class: 'btn btn-default' %>
  </div>
<% end %>
