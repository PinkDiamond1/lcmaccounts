# Be sure to restart your server when you modify this file.

# Your secret key is used for verifying the integrity of signed cookies.
# If you change this key, all old signed cookies will become invalid!

# Make sure the secret is at least 30 characters and all random,
# no regular words or you'll be exposed to dictionary attacks.
# You can use `rake secret` to generate a secure secret key.

# Make sure the secrets in this file are kept private
# if you're sharing your code publicly.

development:
  # Used to encrypt and sign cookies
  # Changing this will invalidate all cookies
  secret_key_base: <%= ENV["SECRET_KEY_BASE"] ||
                       'c2d0f533e8251fdccfe1c0ba771dbf9209aaa520b6dbb5422085064fd7e4b6e5' %>

  # Used to create urls in emails
  email_host: localhost

  environment_name: development

  # Exception email settings
  exception:
    contact_name: OpenStax Accounts
    sender: '"Sender" <sender@localhost>'
    recipients: recipients@localhost

  # Salesforce settings
  salesforce:
    consumer_key: <%= ENV["SALESFORCE_CONSUMER_KEY"] || 'my_salesforce_key' %>
    consumer_secret: <%= ENV["SALESFORCE_CONSUMER_SECRET"] || 'my_salesforce_secret' %>
    login_site: <%= ENV["SALESFORCE_LOGIN_SITE"] || 'https://test.salesforce.com' %>
    mail_recipients: recipients@localhost

  # If this timeout is exceeded, the current job is aborted
  # The job's lock also expires, allowing a new worker to start it
  background_worker_timeout: 300

  # Facebook OAuth API settings
  facebook_app_id: my_facebook_app_id
  facebook_app_secret: my_facebook_app_secret

  # Twitter OAuth API settings
  twitter_consumer_key: my_twitter_consumer_key
  twitter_consumer_secret: my_twitter_consumer_secret

  # Google OAuth API settings
  google_client_id: my_google_client_id
  google_client_secret: my_google_client_secret

  # Trusted hosts for redirects, CORS and loading inside an iframe
  trusted_hosts:
    - openstax.org
    - cnx.org
    - openstax.github.io
    - rdls.org
    - localhost
    - 127.0.0.1

  # Set to true to disable the corner dev/admin console
  disable_corner_console: false

  redis:
    url: <%= ENV["REDIS_URL"] || 'redis://localhost:6379/0' %>
    namespaces:
      cache: <%= ENV["REDIS_NAMESPACES_CACHE"] || "accounts-development-cache" %>
      settings: <%= ENV["REDIS_NAMESPACES_SETTINGS"] || "accounts-development-settings" %>
      jobba: <%= ENV["REDIS_NAMESPACES_LEV"] || "accounts-development-jobba" %>
      salesforce: <%= ENV["REDIS_NAMESPACES_SALESFORCE"] || "accounts-development-salesforce" %>

  # Single Sign On
  sso:
    private_key: "<%= ENV['SSO_PRIVATE_KEY'] || '-----BEGIN RSA PRIVATE KEY-----\n      MIICWwIBAAKBgQC9yuNARRBFVpISF4A9eQL53Xko78uYT6d0tSQFj0hDs1/h2suh\narFmkocK77STkHWKi5ICdXxvi64DMpf22I7lEjy7fH7VFAcu2S5xzracyUeczrN9\nYYlQQY9+L8IHn6mFMuydaQRfhR/tJQhzl9XgNXtEiCvxLv5RlX0GZ0fx1QIDAQAB\nAoGAZKwZDP9VWSJJixUyLelhnb5PxVolKZ6e2bY37EcLcvXT106ikvWwMhNpVHC/\n3UJURvAvu+Qr5FM4M3QDzakjag0HU2ZxXuNajNPFY6er7DY7X3tTE+wCKRFue0em\nCtXaHSrRuEUOiDS1n1X1fwXUR+KbgEbHIYCtBjtnaLN4nyECQQD7AY8b6OBkiu/E\nUdPv3I3TXPoBwO7gSNrE5CXMwPVaYNeXyOo8V9LsJ/ezqykTHU/XnFfIMCbCzqLr\nl1UWbw7tAkEAwZGNO3jdbnisaEYgiiFdyu9fieSMWLgJlyd0lyl/Oz1UcPzlxJNp\n1kL95IEQ9xdjCKZl/6aot+LHdKKNiqkpiQJAUIeFhGzIYTl6B0BBgLj//4na4+kk\nOmzlUznnLrPRg7eCM75P+CAtGXsRK2GEgg9raD9OonlgViu5dWBN+i6TWQJAfqAw\nu879S981KaF2d+YL7U1aOmKATSlXXMI6ywgiayZbru5BgK7OdZOtc2XbK0jpSCdS\nYkMr6982i14rKaIvwQJAMMt6B6rciAZ0EZ+xD7X15VWMlHBHANAyqET8CI1pyBoN\nxed5K462gUia0P4Wqn/m01luDeicTAMls17cfy5Vuw==\n-----END RSA PRIVATE KEY-----\n' %>"
    public_key: "<%= ENV['SSO_PUBLIC_KEY'] || '-----BEGIN PUBLIC KEY-----\n      MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC9yuNARRBFVpISF4A9eQL53Xko\n78uYT6d0tSQFj0hDs1/h2suharFmkocK77STkHWKi5ICdXxvi64DMpf22I7lEjy7\nfH7VFAcu2S5xzracyUeczrN9YYlQQY9+L8IHn6mFMuydaQRfhR/tJQhzl9XgNXtE\niCvxLv5RlX0GZ0fx1QIDAQAB\n-----END PUBLIC KEY-----\n' %>"
    algorithm: <%= ENV['SSO_ALGORITHM'] || 'RSA-OAEP' %>
    encryption_method: <%= ENV['SSO_ENCRYPTION_METHOD'] || 'A256GCM' %>
    cipher: <%= ENV["SSO_CIPHER"] || 'aes-256-cbc' %>
    iterations: <%= ENV["SSO_ITERATIONS"] || 1000 %>
    shared_secret: <%= ENV["SSO_SHARED_SECRET"] ||
                       '265127c36133669bedcf47f326e64e22623c1be35fffe04199f0d86bf45a3485' %>
    shared_secret_salt: <%= ENV["SSO_SHARED_SECRET_SALT"] || 'ox-shared-salt' %>
    cookie:
      old_name: <%= ENV['SSO_COOKIE_OLD_NAME'] || 'ox' %>
      name: <%= ENV['SSO_COOKIE_NAME'] || 'oxa' %>
      options:
        <% if ENV.key?('SSO_COOKIE_DOMAIN') %>
        domain: <%= ENV['SSO_COOKIE_DOMAIN'] %>
        <% end %>
        secure: <%= ActiveModel::Type::Boolean.new.cast ENV.fetch('SSO_COOKIE_SECURE', false) %>
        httponly: <%= ActiveModel::Type::Boolean.new.cast ENV.fetch('SSO_COOKIE_HTTPONLY', true) %>

  # The ip-api.com service gives us location data based on user IP address
  ip_api_key: the_ip_api_key

test:
  # Used to encrypt and sign cookies
  # Changing this will invalidate all cookies
  secret_key_base: fb1c1b629399c0ed18a89c3552955a7c378ce72a10a639df910631b702285149

  # Used to create urls in emails
  email_host: localhost

  environment_name: test

  # If this timeout is exceeded, the current job is aborted
  # The job's lock also expires, allowing a new worker to start it
  background_worker_timeout: 30

  # Exception email settings
  exception:
    contact_name: OpenStax Accounts
    sender: '"Sender" <sender@localhost>'
    recipients: recipients@localhost

  # Salesforce settings
  salesforce:
    consumer_key: <%= ENV["SALESFORCE_CONSUMER_KEY"] || 'my_salesforce_key' %>
    consumer_secret: <%= ENV["SALESFORCE_CONSUMER_SECRET"] || 'my_salesforce_secret' %>
    login_site: <%= ENV["SALESFORCE_LOGIN_SITE"] || 'https://test.salesforce.com' %>
    mail_recipients: recipients@localhost
    tutor_specs_oauth_token: <%= ENV["SALESFORCE_TUTORSPECS_USER_OAUTH_TOKEN"] || 'tutor_specs_oauth_token' %>
    tutor_specs_refresh_token: <%= ENV["SALESFORCE_TUTORSPECS_USER_REFRESH_TOKEN"] || 'tutor_specs_refresh_token' %>
    tutor_specs_instance_url: <%= ENV["SALESFORCE_TUTORSPECS_USER_INSTANCE_URL"] || 'https://cs90.salesforce.com' %>

  # Trusted hosts for redirects, CORS and loading inside an iframe
  trusted_hosts:
    - openstax.org
    - cnx.org
    - openstax.github.io
    - rdls.org
    - localhost
    - 127.0.0.1

  redis:
    url: <%= ENV["REDIS_URL"] || 'redis://localhost:6379/0' %>
    namespaces:
      cache: accounts-test-cache
      settings: accounts-test-settings
      jobba: accounts-test-jobba
      salesforce: accounts-test-salesforce

  # Single Sign On
  sso:
    private_key: |
      -----BEGIN RSA PRIVATE KEY-----
      MIICWwIBAAKBgQC9yuNARRBFVpISF4A9eQL53Xko78uYT6d0tSQFj0hDs1/h2suh
      arFmkocK77STkHWKi5ICdXxvi64DMpf22I7lEjy7fH7VFAcu2S5xzracyUeczrN9
      YYlQQY9+L8IHn6mFMuydaQRfhR/tJQhzl9XgNXtEiCvxLv5RlX0GZ0fx1QIDAQAB
      AoGAZKwZDP9VWSJJixUyLelhnb5PxVolKZ6e2bY37EcLcvXT106ikvWwMhNpVHC/
      3UJURvAvu+Qr5FM4M3QDzakjag0HU2ZxXuNajNPFY6er7DY7X3tTE+wCKRFue0em
      CtXaHSrRuEUOiDS1n1X1fwXUR+KbgEbHIYCtBjtnaLN4nyECQQD7AY8b6OBkiu/E
      UdPv3I3TXPoBwO7gSNrE5CXMwPVaYNeXyOo8V9LsJ/ezqykTHU/XnFfIMCbCzqLr
      l1UWbw7tAkEAwZGNO3jdbnisaEYgiiFdyu9fieSMWLgJlyd0lyl/Oz1UcPzlxJNp
      1kL95IEQ9xdjCKZl/6aot+LHdKKNiqkpiQJAUIeFhGzIYTl6B0BBgLj//4na4+kk
      OmzlUznnLrPRg7eCM75P+CAtGXsRK2GEgg9raD9OonlgViu5dWBN+i6TWQJAfqAw
      u879S981KaF2d+YL7U1aOmKATSlXXMI6ywgiayZbru5BgK7OdZOtc2XbK0jpSCdS
      YkMr6982i14rKaIvwQJAMMt6B6rciAZ0EZ+xD7X15VWMlHBHANAyqET8CI1pyBoN
      xed5K462gUia0P4Wqn/m01luDeicTAMls17cfy5Vuw==
      -----END RSA PRIVATE KEY-----
    public_key: |
      -----BEGIN PUBLIC KEY-----
      MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC9yuNARRBFVpISF4A9eQL53Xko
      78uYT6d0tSQFj0hDs1/h2suharFmkocK77STkHWKi5ICdXxvi64DMpf22I7lEjy7
      fH7VFAcu2S5xzracyUeczrN9YYlQQY9+L8IHn6mFMuydaQRfhR/tJQhzl9XgNXtE
      iCvxLv5RlX0GZ0fx1QIDAQAB
      -----END PUBLIC KEY-----
    algorithm: RSA-OAEP
    encryption_method: A256GCM
    cipher: aes-256-cbc
    iterations: 1000
    shared_secret: 54eb2d4915da54b0ab3b0486c2c4d3e6840264d415b936c663f45da4db90aa37
    shared_secret_salt: ox-shared-salt
    cookie:
      old_name: ox
      name: oxa
      options:
        secure: false
        httponly: true

  # The ip-api.com service gives us location data based on user IP address
  ip_api_key: the_ip_api_key
